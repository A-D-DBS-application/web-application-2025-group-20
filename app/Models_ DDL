-- 1. Users
CREATE TABLE users (
    username text NOT NULL,
    role text,
    created_at timestamp with time zone DEFAULT now(),
    CONSTRAINT users_pkey PRIMARY KEY (username)
);

-- 2. Debtors
CREATE TABLE debtors (
    national_id uuid NOT NULL DEFAULT gen_random_uuid(),
    name text,
    address text,
    btw_nummer text,
    health_indicator text,
    created_at timestamp with time zone DEFAULT now(),
    user_username text,
    CONSTRAINT debtors_pkey PRIMARY KEY (national_id),
    CONSTRAINT debtors_user_username_fkey FOREIGN KEY (user_username)
        REFERENCES users (username)
);

-- 3. Financial Data
-- Zonder FK, alleen PK op btw + jaar
CREATE TABLE financial_data (
    btw_nummer text NOT NULL,
    year integer NOT NULL,
    created_at timestamp with time zone DEFAULT now(),
    current_ratio real,
    quick_ratio real,
    solvabiliteitsscore real,
    CONSTRAINT financial_data_pkey PRIMARY KEY (btw_nummer, year)
);

-- 4. Audit Log
CREATE TABLE audit_log (
    id uuid NOT NULL DEFAULT gen_random_uuid(),
    action text,
    resource_id text,
    username text,
    "timestamp" timestamp with time zone DEFAULT now(),
    CONSTRAINT audit_log_pkey PRIMARY KEY (id),
    CONSTRAINT audit_log_username_fkey FOREIGN KEY (username)
        REFERENCES users (username)
);






